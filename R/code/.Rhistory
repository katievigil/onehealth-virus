theme(
axis.text.x = element_text(angle = 45, size = 15),
axis.text.y = element_text(size = 15),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 14)  # Increase legend text size
) +
guides(size = guide_legend(title = "Alignment Count"),
fill = guide_legend(title = "Sample Type"))  # Add "Sample Type" legend title
ggplot(virus_data, aes(x = sample.type, y = host, size = counts, color = sample.type)) +
geom_point(alpha = 0.7) +  # Creates the bubble plot
scale_size_continuous(range = c(3, 20)) +  # Adjust the bubble sizes
labs(
title = "D",
x = "Sample Type",
y = "Vertebrate Virus Host",
size = "Alignment Count"
) +
theme_minimal() +  # Optional: for a cleaner look
theme(
axis.text.x = element_text(angle = 45, size = 15, face = "bold"),
axis.text.y = element_text(size = 15, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 14)  # Increase legend text size
) +
guides(size = guide_legend(title = "Alignment Count"),
fill = guide_legend(title = "Sample Type"))  # Add "Sample Type" legend title
ggplot(virus_data, aes(x = sample.type, y = host, size = counts, color = sample.type)) +
geom_point(alpha = 0.7) +  # Creates the bubble plot
scale_size_continuous(range = c(3, 20)) +  # Adjust the bubble sizes
labs(
title = "D",
x = "Sample Type",
y = "Vertebrate Virus Host",
size = "Alignment Count"
) +
theme_minimal() +  # Optional: for a cleaner look
theme(
axis.text.x = element_text(angle = 45, size = 15, face = "bold"),
axis.text.y = element_text(size = 15, face = "bold"),
axis.title.x = element_text(size = 15, face = "bold"),
axis.title.y = element_text(size = 15, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 14)  # Increase legend text size
) +
guides(size = guide_legend(title = "Alignment Count"),
fill = guide_legend(title = "Sample Type"))  # Add "Sample Type" legend title
ggplot(virus_data, aes(x = sample.type, y = host, size = counts, color = sample.type)) +
geom_point(alpha = 0.7) +  # Creates the bubble plot
scale_size_continuous(range = c(3, 20)) +  # Adjust the bubble sizes
labs(
title = "D",
x = "Sample Type",
y = "Vertebrate Virus Host",
size = "Alignment Count"
) +
theme_minimal() +  # Optional: for a cleaner look
theme(
axis.text.x = element_text(angle = 45, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 15, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 15)  # Increase legend text size
) +
guides(size = guide_legend(title = "Alignment Count"),
fill = guide_legend(title = "Sample Type"))  # Add "Sample Type" legend title
ggplot(virus_data, aes(x = sample.type, y = type, size = counts, color = sample.type)) +
geom_point(alpha = 0.7) +  # Creates the bubble plot
scale_size_continuous(range = c(3, 20)) +  # Adjust the bubble sizes
labs(title = "B",
x = "Sample Type",
y = "Vertebrate Virus Type",
size = "Alignment Count") +
theme_minimal() +  # Optional: for a cleaner look
theme(
axis.text.x = element_text(angle = 45, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 15, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 15)  # Increase legend text size
####Bubble plot with alignments and abundance data
# Filter the data
filtered_data <- virus_data %>%
ggplot(virus_data, aes(x = sample.type, y = host, size = counts, color = sample.type)) +
geom_point(alpha = 0.7) +  # Creates the bubble plot
scale_size_continuous(range = c(3, 20)) +  # Adjust the bubble sizes
labs(
title = "D",
x = "Sample Type",
y = "Vertebrate Virus Host",
size = "Alignment Count"
) +
theme_minimal() +  # Optional: for a cleaner look
theme(
axis.text.x = element_text(angle = 45, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 15, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 15)  # Increase legend text size
) +
guides(size = guide_legend(title = "Alignment Count"),
fill = guide_legend(title = "Sample Type"))  # Add "Sample Type" legend title
ggplot(virus_data, aes(x = sample.type, y = type, size = counts, color = sample.type)) +
geom_point(alpha = 0.7) +  # Creates the bubble plot
scale_size_continuous(range = c(3, 20)) +  # Adjust the bubble sizes
labs(title = "B",
x = "Sample Type",
y = "Vertebrate Virus Type",
size = "Alignment Count") +
theme_minimal() +  # Optional: for a cleaner look
theme(
axis.text.x = element_text(angle = 45, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 15, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 15)  # Increase legend text size
) +
guides(size = guide_legend(title = "Alignment Count"),
fill = guide_legend(title = "Sample Type"))  # Add "Sample Type" legend title
ggplot(filtered_data, aes(x = sample.type, y = family, size = counts, color = sample.type)) +
geom_point(alpha = 0.7) +  # Creates the bubble plot
scale_size_continuous(range = c(3, 20)) +  # Adjust the bubble sizes
labs(title = "F",
x = "Sample Type",
y = "Vertebrate Virus Family",
size = "Alignment Count") +
theme_minimal() +  # Optional: for a cleaner look
theme(
axis.text.x = element_text(angle = 45, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 15, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 15)  # Increase legend text size
) +
guides(size = guide_legend(title = "Alignment Count"),
fill = guide_legend(title = "Sample Type"))  # Add "Sample Type" legend title
ggplot(filtered_data, aes(x = sample.type, y = genus, size = counts, color = sample.type)) +
geom_point(alpha = 0.7) +  # Creates the bubble plot
scale_size_continuous(range = c(3, 20)) +  # Adjust the bubble sizes
labs(title = "H",
x = "Sample Type",
y = "Vertebrate Virus Genus",
size = "Alignment Count") +
theme_minimal() +  # Optional: for a cleaner look
theme(
axis.text.x = element_text(angle = 45, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 15, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 15)  # Increase legend text size
) +
guides(size = guide_legend(title = "Alignment Count"),
fill = guide_legend(title = "Sample Type"))  # Add "Sample Type" legend title
# Create the bubble plot for host
a <- ggplot(virus_data, aes(x = sample.type, y = host, size = counts, color = sample.type)) +
geom_point(alpha = 0.7) +  # Creates the bubble plot
scale_size_continuous(range = c(3, 20)) +  # Adjust the bubble sizes
labs(
title = "D",
x = "Sample Type",
y = "Vertebrate Virus Host",
size = "Alignment Count"
) +
theme_minimal() +  # Optional: for a cleaner look
theme(
axis.text.x = element_text(angle = 45, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 15, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 15)  # Increase legend text size
) +
guides(size = guide_legend(title = "Alignment Count"),
fill = guide_legend(title = "Sample Type"))  # Add "Sample Type" legend title
# Create the bubble plot for virus type
b <- ggplot(virus_data, aes(x = sample.type, y = type, size = counts, color = sample.type)) +
geom_point(alpha = 0.7) +  # Creates the bubble plot
scale_size_continuous(range = c(3, 20)) +  # Adjust the bubble sizes
labs(title = "B",
x = "Sample Type",
y = "Vertebrate Virus Type",
size = "Alignment Count") +
theme_minimal() +  # Optional: for a cleaner look
theme(
axis.text.x = element_text(angle = 45, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 15, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 15)  # Increase legend text size
) +
guides(size = guide_legend(title = "Alignment Count"),
fill = guide_legend(title = "Sample Type"))  # Add "Sample Type" legend title
# Create the bubble plot for only vertebrate families
c <- ggplot(filtered_data, aes(x = sample.type, y = family, size = counts, color = sample.type)) +
geom_point(alpha = 0.7) +  # Creates the bubble plot
scale_size_continuous(range = c(3, 20)) +  # Adjust the bubble sizes
labs(title = "F",
x = "Sample Type",
y = "Vertebrate Virus Family",
size = "Alignment Count") +
theme_minimal() +  # Optional: for a cleaner look
theme(
axis.text.x = element_text(angle = 45, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 15, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 15)  # Increase legend text size
) +
guides(size = guide_legend(title = "Alignment Count"),
fill = guide_legend(title = "Sample Type"))  # Add "Sample Type" legend title
# Create the bubble plot for only vertebrate genus
d <- ggplot(filtered_data, aes(x = sample.type, y = genus, size = counts, color = sample.type)) +
geom_point(alpha = 0.7) +  # Creates the bubble plot
scale_size_continuous(range = c(3, 20)) +  # Adjust the bubble sizes
labs(title = "H",
x = "Sample Type",
y = "Vertebrate Virus Genus",
size = "Alignment Count") +
theme_minimal() +  # Optional: for a cleaner look
theme(
axis.text.x = element_text(angle = 45, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 15, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 15)  # Increase legend text size
) +
guides(size = guide_legend(title = "Alignment Count"),
fill = guide_legend(title = "Sample Type"))  # Add "Sample Type" legend title
# Filter the data
filtered_data <- virus_data %>%
filter(host == "vertebrate")
ggplot(type_counts, aes(x = sample.type, y = type, fill = log_count)) +
geom_tile(color = "gray80") +
scale_fill_gradientn(colors = c("white", "blue", "red"), name = "Log(Virus Counts)", na.value = "gray90") +
labs(title = "A", x = "Sample Type", y = "Virus Type") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold")
) +
facet_grid(. ~ region, scales = "free_x", space = "free_x")
ggplot(type_counts, aes(x = sample.type, y = type, fill = log_count)) +
geom_tile(color = "gray80") +
scale_fill_gradientn(colors = c("white", "blue", "red"), name = "Log(Virus Counts)", na.value = "gray90") +
labs(title = "A", x = "Sample Type", y = "Virus Type") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold")
) +
facet_grid(. ~ region, scales = "free_x", space = "free_x")
ggplot(type_counts, aes(x = sample.type, y = type, fill = log_count)) +
geom_tile(color = "gray80") +
scale_fill_gradientn(colors = c("white", "blue", "red"), name = "Log(Virus Counts)", na.value = "gray90") +
labs(title = "A", x = "Sample Type", y = "Virus Type") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 14),  # Increase legend text size
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold")
) +
facet_grid(. ~ region, scales = "free_x", space = "free_x")
# Plot for Virus Counts by Type and Sample Type
plot_A <- ggplot(type_counts, aes(x = sample.type, y = type, fill = log_count)) +
geom_tile(color = "gray80") +
scale_fill_gradientn(colors = c("white", "blue", "red"), name = "Log(Virus Counts)", na.value = "gray90") +
labs(title = "A", x = "Sample Type", y = "Virus Type") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 14),  # Increase legend text size
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold")
) +
facet_grid(. ~ region, scales = "free_x", space = "free_x")
# Plot for Virus Counts by Host and Sample Type
plot_B <- ggplot(host_counts, aes(x = sample.type, y = host, fill = log_count)) +
geom_tile(color = "gray80") +
scale_fill_gradientn(colors = c("white", "blue", "red"), name = "Log(Virus Counts)", na.value = "gray90") +
labs(title = "C", x = "Sample Type", y = "Virus Host") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 14),  # Increase legend text size
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold")
) +
facet_grid(. ~ region, scales = "free_x", space = "free_x")
# Plot for Virus Counts by Family (Vertebrate Hosts Only) and Sample Type
plot_C <- ggplot(family_counts, aes(x = sample.type, y = family, fill = log_count)) +
geom_tile(color = "gray80") +
scale_fill_gradientn(colors = c("white", "blue", "red"), name = "Log(Virus Counts)", na.value = "gray90") +
labs(title = "E", x = "Sample Type", y = "Vertebrate Virus Family") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 14),  # Increase legend text size
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold")
) +
facet_grid(. ~ region, scales = "free_x", space = "free_x")
# Plot for Virus Counts by Genus (Vertebrate Hosts Only) and Sample Type
plot_D <- ggplot(genus_counts, aes(x = sample.type, y = genus, fill = log_count)) +
geom_tile(color = "gray80") +
scale_fill_gradientn(colors = c("white", "blue", "red"), name = "Log(Virus Counts)", na.value = "gray90") +
labs(title = "G", x = "Sample Type", y = "Vertebrate Virus Genus") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 14),  # Increase legend text size
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold")
) +
facet_grid(. ~ region, scales = "free_x", space = "free_x")
# Combine all plots into one grid
combined_plot <- plot_A + plot_B + plot_C + plot_D + plot_layout(ncol = 2)
# Define the file path where you want to save the image
file_path <- "C:/Users/kvigil/OneDrive - Oxford Nanopore Technologies/results/katie/epi2me_out/R/results/combined_heatmap.png"
# Save the combined plot as a high-resolution image (e.g., PNG) at the specified location
ggsave(file_path, combined_plot, width = 16, height = 12, dpi = 300)
bubble_heatmap <- plot_A + b + plot_B + a + plot_C + c + plot_D + d + plot_layout(ncol = 2)
# Define the file path where you want to save the image
file <- "C:/Users/kvigil/OneDrive - Oxford Nanopore Technologies/results/katie/epi2me_out/R/results/bubble_plot_heatmap.png"
# Save the combined plot as a high-resolution image (e.g., PNG) at the specified location
ggsave(file, bubble_heatmap, width = 25, height = 35, dpi = 600)
ggsave(file, bubble_heatmap, width = 25, height = 40, dpi = 700, device = "tiff")
ggsave(file, bubble_heatmap, width = 25, height = 42, dpi = 700, device = "tiff")
# Save the combined plot as a high-resolution image (e.g., PNG) at the specified location
ggsave(file, bubble_heatmap, width = 30, height = 42, dpi = 650)
# Plot for Virus Counts by Type and Sample Type
plot_A <- ggplot(type_counts, aes(x = sample.type, y = type, fill = log_count)) +
geom_tile(color = "gray80") +
scale_fill_gradientn(colors = c("white", "blue", "red"), name = "Log(Virus Counts)", na.value = "gray90") +
labs(title = "A", x = "Sample Type", y = "Virus Type") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 14),  # Increase legend text size
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold")
) +
facet_grid(. ~ region, scales = "free_x", space = "free_x")
# Plot for Virus Counts by Host and Sample Type
plot_B <- ggplot(host_counts, aes(x = sample.type, y = host, fill = log_count)) +
geom_tile(color = "gray80") +
scale_fill_gradientn(colors = c("white", "blue", "red"), name = "Log(Virus Counts)", na.value = "gray90") +
labs(title = "C", x = "Sample Type", y = "Virus Host") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 14),  # Increase legend text size
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold")
) +
facet_grid(. ~ region, scales = "free_x", space = "free_x")
# Plot for Virus Counts by Family (Vertebrate Hosts Only) and Sample Type
plot_C <- ggplot(family_counts, aes(x = sample.type, y = family, fill = log_count)) +
geom_tile(color = "gray80") +
scale_fill_gradientn(colors = c("white", "blue", "red"), name = "Log(Virus Counts)", na.value = "gray90") +
labs(title = "E", x = "Sample Type", y = "Vertebrate Virus Family") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 14),  # Increase legend text size
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold")
) +
facet_grid(. ~ region, scales = "free_x", space = "free_x")
# Plot for Virus Counts by Genus (Vertebrate Hosts Only) and Sample Type
plot_D <- ggplot(genus_counts, aes(x = sample.type, y = genus, fill = log_count)) +
geom_tile(color = "gray80") +
scale_fill_gradientn(colors = c("white", "blue", "red"), name = "Log(Virus Counts)", na.value = "gray90") +
labs(title = "G", x = "Sample Type", y = "Vertebrate Virus Genus") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 16, face = "bold"),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.x = element_text(size = 16, face = "bold"),
axis.title.y = element_text(size = 16, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
legend.title = element_text(size = 16, face = "bold"),  # Increase legend title size
legend.text = element_text(size = 14),  # Increase legend text size
strip.placement = "outside",
strip.background = element_blank(),
strip.text = element_text(size = 12, face = "bold")
) +
facet_grid(. ~ region, scales = "free_x", space = "free_x")
# Combine all plots into one grid
combined_plot <- plot_A + plot_B + plot_C + plot_D + plot_layout(ncol = 2)
bubble_heatmap <- plot_A + b + plot_B + a + plot_C + c + plot_D + d + plot_layout(ncol = 2)
bubble_heatmap
# Save the combined plot as a high-resolution image (e.g., PNG) at the specified location
ggsave(file, bubble_heatmap, width = 30, height = 42, dpi = 650)
